"use strict";function docReady(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,1):document.addEventListener("DOMContentLoaded",e)}docReady(function(){let e=document.querySelectorAll(".castos-player");e.forEach(function(n){let s=n.dataset.player_id,r=window["ssp_castos_player_"+s],i=n.dataset.episode,e=n.querySelector(".ssp-playback"),t,a=n.querySelector(".play-btn"),c=n.querySelector(".pause-btn"),l=n.querySelector(".player__artwork"),o=n.querySelector(".ssp-duration"),d=n.querySelector(".ssp-timer"),u=n.querySelector(".ssp-progress"),p=n.querySelector(".progress__filled"),y=e.querySelectorAll("[data-skip]"),f=n.querySelector(".player-btn__volume"),v=n.querySelector(".player-btn__speed"),_=n.querySelector(".ssp-loader"),m=n.querySelector(".playlist__items"),L=n.querySelector(".player__podcast-title"),S=n.querySelector(".player__episode-title"),E=n.querySelector(".playlist__wrapper"),h=!!E,q;function k(e){return(""+(e+100)).substring(1)}function b(e){var t=Math.floor(e/3600);e%=3600;let n=Math.floor(e/60),i=Math.floor(e%60),s=0;return s=0<t?k(t)+" : "+k(n)+" : "+k(i):k(n)+":"+k(i),s}function g(){t.paused?(t.play(),x()):T()}function T(){t.pause(),x()}function x(){t.paused?(c.classList.add("hide"),a.classList.remove("hide")):(c.classList.remove("hide"),a.classList.add("hide"))}function M(){o.innerHTML=b(t.duration)}function w(){var e=t.currentTime/t.duration*100;p.style.flexBasis=e+"%"}function C(e){t.currentTime=e.offsetX/u.offsetWidth*t.duration}function H(){t.currentTime+=parseFloat(this.dataset.skip)}function A(){_.classList.remove("hide")}function R(){_.classList.add("hide")}function O(){R(),t=n.querySelector(".clip-"+i),t.addEventListener("play",x),t.addEventListener("pause",x),t.addEventListener("playing",x),t.addEventListener("playing",M),t.addEventListener("timeupdate",w),t.ontimeupdate=function(){d.innerHTML=b(t.currentTime)},t.onended=function(){c.classList.add("hide"),a.classList.remove("hide");let e=n.querySelector(".playlist__item.active"),t=e.nextElementSibling;if(e.classList.remove("active"),t){let e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!1),t.dispatchEvent(e)}},t.addEventListener("waiting",A),t.addEventListener("canplay",R)}a.addEventListener("click",g),c.addEventListener("click",g),l.addEventListener("click",g),v.addEventListener("click",function(){var e=this.dataset.speed<2?(parseFloat(this.dataset.speed)+.2).toFixed(1):1;v.setAttribute("data-speed",e),v.innerHTML=e+"x",t.playbackRate=e}),y.forEach(function(e){return e.addEventListener("click",H)}),f.addEventListener("click",function(){1===t.volume?(t.volume=0,f.classList.add("off")):(t.volume=1,f.classList.remove("off"))});let F=!1;u.addEventListener("click",C),u.addEventListener("mousemove",function(e){return F&&C(e)}),u.addEventListener("mousedown",function(){return F=!0}),u.addEventListener("mouseup",function(){return F=!1});let j=n.querySelector(".subscribe-btn"),J=n.querySelector(".player-panels .subscribe"),N=n.querySelector(".player-panels .subscribe .close-btn"),X=n.querySelector(".share-btn"),B=n.querySelector(".player-panels .share"),D=n.querySelector(".player-panels .share .close-btn"),G=n.querySelector(".input-link"),P=n.querySelector(".copy-link"),U=n.querySelector(".input-embed"),W=n.querySelector(".copy-embed"),z=n.querySelector(".input-rss"),I=n.querySelector(".copy-rss");function K(e){e.classList.contains("open")?e.classList.remove("open"):e.classList.add("open")}function Q(e){e.select(),document.execCommand("Copy")}function V(){var e,t;this.dataset.episode!==i&&(m.querySelectorAll(".playlist__item").forEach(function(e){e.classList.remove("active")}),this.classList.add("active"),e=this.querySelector(".playlist__episode-title"),t=this.querySelector(".playlist__item__cover img"),L.textContent=e.dataset.podcast,S.textContent=e.textContent,l.querySelector("img").src=t.src,T(),i=this.dataset.episode,O(),setTimeout(function(){g()},500))}function Y(){function i(){q.style.display="none",E.dataset.processing=""}E.dataset.processing||q.scrollHeight-q.scrollTop!==q.clientHeight||function(){q.style.display="block",E.dataset.processing="1";let e=new XMLHttpRequest,t=new URL(r.ajax_url);var n={action:"get_playlist_items",atts:JSON.stringify(r.atts),page:++E.dataset.page,player_id:s,nonce:r.nonce};Object.keys(n).forEach(function(e){t.searchParams.set(e,n[e])}),e.open("GET",t.toString(),!0),e.onload=function(){if(200===this.status){let e=JSON.parse(this.response);0<e.data.length?e.data.forEach(function(e){let t=function(e){let t=document.createElement("div");return t.innerHTML='<li class="playlist__item" data-episode="'+e.episode_id+'"><div class="playlist__item__cover"><img src="'+e.album_art.src+'" title="'+e.title+'" alt="'+e.title+'" /></div><div class="playlist__item__details"><h2 class="playlist__episode-title" data-podcast="'+e.podcast_title+'">'+e.title+"</h2><p>"+e.date+" â€¢ "+e.duration+'</p><p class="playlist__episode-description">'+e.excerpt+'</p></div><audio preload="none" class="clip clip-'+e.episode_id+'"><source src="'+e.audio_file+'"></audio></li>',t.firstChild}(e);m.appendChild(t),t.addEventListener("click",V)}):E.removeEventListener("scroll",Y)}i()},e.onerror=function(){i()},e.send()}()}j&&j.addEventListener("click",function(){return K(J)}),N&&N.addEventListener("click",function(){return K(J)}),X&&X.addEventListener("click",function(){return K(B)}),D&&D.addEventListener("click",function(){return K(B)}),P&&P.addEventListener("click",function(){return Q(G)}),W&&W.addEventListener("click",function(){return Q(U)}),I&&I.addEventListener("click",function(){return Q(z)}),h&&(q=E.querySelector(".loader"),function(){let e=m.querySelectorAll(".playlist__item");e&&e.forEach(function(e){e.addEventListener("click",V)}),E&&E.addEventListener("scroll",Y)}()),O()})});